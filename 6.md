# Level 6: Reykjavik

## Quick look

We run the program and hodiho! It seems like at one point our `pc` gets lost and doesn't follow the initial path. 

Entering a large number of *a* we see that they get stored at address `43da` in memory and that we can enter a maximum of 62 a's (15bytes + 2 bits).

## Encryption

If you look at the code, you can see that all `enc` does is looping and modifying bits of memory. Basically what it does is **building instructions** that we will read afterward by **pointing the Program Counter on them**. It's mostly incomprehensible so let's not waste time with this. `r pc 100` gives us the hexadecimal code that we can then Disassemble through Microcorruption Disassembler, or we can just step through it and observe what is really happening through the Current Instruction window.

![disassembler](img/5_1.PNG)

We step through the code until we get prompted by the pop-up asking for a password. We can then check that it gets saved into the stack (`r sp`).

Right after the popup, this code appears:

`b490 b26b dcff cmp #0x6bb2, -0x24(r4)`

The instruction compares `0x6bb2` with what is at the address pointed by r4, minus 24 bytes. Magically, this where our password is stored. Remember, **the instruction `cmp` compares 16bits in MSP430**, so the password starts like this: `0xb26b` (remember we are in **little endian**!). Stepping through the code we don't see anymore `cmp`. Let's try this value as a password. **It works!**